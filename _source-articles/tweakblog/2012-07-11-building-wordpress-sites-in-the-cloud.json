{
    "title": "Building Wordpress sites in the cloud",
    "language": "nl",
    "link": "http://glamour.tweakblogs.net/blog/8051/building-wordpress-sites-in-the-cloud.html",
    "date": "2012-07-11T13:20:00.000Z",
    "category": "Frontend",
    "views": 36346,
    "articleHtml": "As part of the <a href=\"http://c9.io/site/features/\" rel=\"external\">new</a> features that we launched two weeks in <a href=\"http://c9.io\" rel=\"external\">Cloud9 IDE</a> we&apos;ve added support for Python, Ruby and PHP as server side languages besides node.js. That&apos;s not just it, because users have full freedom over the VM that we run your code on so they can install any platform they like (C++ development in the cloud f.e.). The cool thing is that it&apos;s now possible to bring all sorts of already existing applications into Cloud9, without relying on third parties to do the actual Apache hosting etc. because you&apos;ll just get an Openshift server. In this post I&apos;ll show a step by step demo of how to use Cloud9 to build a Wordpress application without leaving the browser.<br>\r\n<br>\r\nIf you want to see the quickest demo possible, sign up for Cloud9 at <a href=\"http://c9.io\" rel=\"external\">c9.io</a>, log in via GitHub and create an index.php file:<br>\r\n<br>PHP:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br></code></td><td class=\"phphighlightcode\"><div><code>&lt;?<span class=\"code_ident\">php</span>\n<br><span class=\"code_keyword\">echo</span>&#xA0;<span class=\"code_string\">&apos;Hello&#xA0;world&apos;</span></code></div></td></tr></table><br>\r\n<br>\r\nWhen you now click the &apos;Debug&apos; button we spawn a shell version of PHP that echoes &apos;Hello world&apos; back to you. To run it via Apache go to the run panel, select &apos;Apache+PHP&apos; and re-click &apos;Debug&apos;.<br>\r\n<br>\r\n<img src=\"http://100procentjan.nl/tweakers/wp1.png\" title=\"http://100procentjan.nl/tweakers/wp1.png\" alt=\"http://100procentjan.nl/tweakers/wp1.png\"><br><a name=\"more\"></a><br>\r\n<b>Installing wordpress</b><br>\r\nTo install wordpress, we&apos;ll download the <a href=\"http://wordpress.org/latest.zip\" rel=\"external\">latest .zip file</a>, unzip it. Then right click on the root folder in your tree and select &apos;Upload files&apos; and choose the wordpress folder. Because the folder upload the files are in a seperate subfolder under root. Drag them to root and remove the &apos;wordpress&apos; folder. Rename the &apos;wp-config-sample.php&apos; to &apos;wp-config.php&apos;.<br>\r\n<br>\r\n<i>Or do it via the terminal (CMD+T, CTRL+T)</i><br>\r\n<br>bash:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><pre>1\n2\n3\n4\n5\n</pre></td><td class=\"phphighlightcode\"><div><pre>$ wget http://wordpress.org/latest.tar.gz\r\n$ tar xzfv latest.tar.gz\r\n$ cp -r wordpress/* .\r\n$ rm latest.tar.gz\r\n$ rm -rf wordpress</pre></div></td></tr></table><br>\r\n<br>\r\n<b>Running wordpress</b><br>\r\nWhen you now click &apos;Debug&apos; and open the site, an error is thrown that no database connection could be made. That&apos;s correct, because we don&apos;t have a database server running on this machine. To make this fun we&apos;ll run Wordpress with PostgreSQL instead of MySQL. To get that to work we&apos;ll need to install the <a href=\"http://wordpress.org/extend/plugins/postgresql-for-wordpress/installation/\" rel=\"external\">pg4wp</a> plugin first. Follow the steps in the installation page to add the driver. We still have no connection, because no database was installed on the virtual machine in Cloud9 but now we&apos;ve got something to get started with. Let&apos;s install Postgres first!<br>\r\n<br>\r\n<b>Installing PostgreSQL</b><br>\r\nCloud9 comes with a fully functional shell, that can be opened via &apos;View&apos;-&gt;&apos;Terminals&apos;-&gt;&apos;New Terminal&apos;. This is just a SSH connection that you&apos;d normally have to servers in your data center. That means that you have a limitless environment where you can install stuff (yes even vi!).<br>\r\n<br>\r\n<img src=\"http://100procentjan.nl/tweakers/wp2.png\" title=\"http://100procentjan.nl/tweakers/wp2.png\" alt=\"http://100procentjan.nl/tweakers/wp2.png\"><br>\r\n<br>\r\nFirst we&apos;ll need to have the Postgres sources, then configure it, and finally make, install and start the server (and yes, this might take a while!).<br>\r\n<br>bash:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><pre>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n</pre></td><td class=\"phphighlightcode\"><div><pre>$ cd ..\r\n$ mkdir pgsource\r\n$ cd pgsource            # go into new directory\r\n$ wget http://ftp.postgresql.org/pub/source/v9.1.4/postgresql-9.1.4.tar.gz        # grab source code\r\n$ tar xzfv postgresql-9.1.4.tar.gz         # untar it\r\n$ cd postgresql-9.1.4\r\n$ ./configure --without-readline --prefix=$PWD/../postgres         # configure\r\n$ make\r\n$ make install\r\n# now to start it\r\n$ cd ~/pgsource/postgres/bin\r\n$ ./initdb -D ../data\r\n$ ./pg_ctl -D ../data -l logfile start\r\n$ ./createdb wp</pre></div></td></tr></table><br>\r\n<br>\r\nWith a running postgres instance (you can add the bin/ folder to your path if you like) which can be verified by running ./psql, and a created database we can now configure Wordpress to use this database. In &apos;wp-config.php&apos; change the database settings to (don&apos;t have to restart debugging, changes are immediate!):<br>\r\n<br>PHP:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code><br>1<br>2<br>3<br>4<br>5<br>6<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_preproc\">&lt;?php\n<br></span><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_NAME&apos;</span>,&#xA0;<span class=\"code_string\">&apos;wp&apos;</span>);\n<br><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_USER&apos;</span>,&#xA0;<span class=\"code_string\">&apos;&apos;</span>);\n<br><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_PASSWORD&apos;</span>,&#xA0;<span class=\"code_string\">&apos;&apos;</span>);\n<br><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_HOST&apos;</span>,&#xA0;<span class=\"code_string\">&apos;localhost:5432&apos;</span>);\n<br><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_CHARSET&apos;</span>,&#xA0;<span class=\"code_string\">&apos;utf8&apos;</span>);\n<br><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_COLLATE&apos;</span>,&#xA0;<span class=\"code_string\">&apos;&apos;</span>);<span class=\"code_preproc\">\n<br>?&gt;</span></code></div></td></tr></table><br>\r\n<img src=\"http://100procentjan.nl/tweakers/wp3.png\" title=\"http://100procentjan.nl/tweakers/wp3.png\" alt=\"http://100procentjan.nl/tweakers/wp3.png\"><br>\r\n<br>\r\nA running wordpress install, that you can use, modify and edit live from cloud9.<br>\r\n<br>\r\n<b>A hosted database solution (also for free users)</b><br>\r\nBecause a local database won&apos;t hold when deploying this to a cloud service, we&apos;ll use the <a href=\"https://postgres.heroku.com/\" rel=\"external\">hosted postgres</a> solution that Heroku offers. Select the dev plan (which is free) and create a database. Click on your new database to get the connection settings (hostname, username, password, etc.). To use this from within Cloud9 we can now load different configurations per environment, because on C9 the &apos;C9_PROJECT&apos; environment variable is present.<br>\r\n<br>PHP:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code><br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_preproc\">&lt;?php\n<br></span><span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_method\">getenv</span>(<span class=\"code_string\">&quot;C9_PROJECT&quot;</span>))&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_NAME&apos;</span>,&#xA0;<span class=\"code_string\">&apos;wp&apos;</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_USER&apos;</span>,&#xA0;<span class=\"code_string\">&apos;&apos;</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_PASSWORD&apos;</span>,&#xA0;<span class=\"code_string\">&apos;&apos;</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_HOST&apos;</span>,&#xA0;<span class=\"code_string\">&apos;localhost:5432&apos;</span>);\n<br>}\n<br><span class=\"code_keyword\">else</span>&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_NAME&apos;</span>,&#xA0;<span class=\"code_string\">&apos;HEROKUDBNAME&apos;</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_USER&apos;</span>,&#xA0;<span class=\"code_string\">&apos;HEROKUUSER&apos;</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_PASSWORD&apos;</span>,&#xA0;<span class=\"code_string\">&apos;HEROKUPWD&apos;</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_HOST&apos;</span>,&#xA0;<span class=\"code_string\">&apos;HEROKUHOST.compute-1.amazonaws.com:5432&apos;</span>);\n<br>}\n<br>\n<br><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_CHARSET&apos;</span>,&#xA0;<span class=\"code_string\">&apos;utf8&apos;</span>);\n<br><span class=\"code_method\">define</span>(<span class=\"code_string\">&apos;DB_COLLATE&apos;</span>,&#xA0;<span class=\"code_string\">&apos;&apos;</span>);<span class=\"code_preproc\">\n<br>?&gt;</span></code></div></td></tr></table><br>\r\n<br>\r\nIf you want to migrate data from local -&gt; hosted database, you can use the normal postgres tooling like pg_dump.<br>\r\n<br>\r\n<b>Deploying the application to Heroku</b><br>\r\nNow time to deploy this application to Heroku&apos;s hosted applications solution. Go to the &apos;Deploy&apos; tab in Cloud9 (fourth tab with the balloon) and choose &apos;+&apos;.<br>\r\n<br>\r\n<img src=\"http://100procentjan.nl/tweakers/wp4.png\" title=\"http://100procentjan.nl/tweakers/wp4.png\" alt=\"http://100procentjan.nl/tweakers/wp4.png\"><br>\r\n<br>\r\nChoose Heroku, log in with your fresh credentials and create a new app. Give it any name you like and click &apos;Add&apos;. Because Cloud9 enforces a Procfile which is not required for PHP apps at the moment, we now need to manually push instead of via the UI. In the console (SHIFT+ESC) type:<br>\r\n<br>bash:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><pre>1\n2\n3\n4\n</pre></td><td class=\"phphighlightcode\"><div><pre>$ git remote add heroku git@heroku.com:APPNAME.git\r\n$ git add .\r\n$ git commit -m &quot;Initial commit&quot;\r\n$ git push heroku master</pre></div></td></tr></table> <br>\r\n<img src=\"http://100procentjan.nl/tweakers/wp5.png\" title=\"http://100procentjan.nl/tweakers/wp5.png\" alt=\"http://100procentjan.nl/tweakers/wp5.png\"><br>\r\n<br>\r\nAnd now your application has been deployed to the URL mentioned in the console message. For example: here is <a href=\"http://wordpressjan.herokuapp.com/\" rel=\"external\">my brand new blog</a>!<br>\r\n<br>\r\n<b>Updating the site</b><br>\r\nIn case you want to edit the PHP files, just edit them in Cloud9; test them via the built in Apache process, and when you&apos;re ready do a &apos;git add&apos; for the files you edited, commit them and push to heroku. Easy as that!<br>\r\n<br>\r\n<b>Like Cloud9?</b><br>\r\nWe&apos;re open source, so if you have cool improvements that you&apos;d like to contribute, see the <a href=\"http://github.com/ajaxorg/cloud9\" rel=\"external\">GitHub</a> page. The VMs terminal stuff are only available on the hosted version, but you can roll your own by install c9 on your own cloud VM (f.e. on Amazon).<br>\r\n<br>\r\nHappy coding!",
    "nextLink": "http://glamour.tweakblogs.net/blog/7818/rate-limited-website-scraping-with-node-punt-js-and-async.html",
    "comments": [
        {
            "author": "truegrit",
            "date": "woensdag 11 juli 2012 19:32",
            "contentHtml": "I fiddled with c9 in the past for a bit, but i was unaware it had so much possibilities. I shall have to try it out some day",
            "ownReply": false
        },
        {
            "author": "Vold",
            "date": "woensdag 11 juli 2012 20:16",
            "contentHtml": "I didn&apos;t knew you could deploy php apps to Heroku with such ease! I used cloud9 a while ago, but I thought it was too buggy back then, I looks way more stable now!<br>\r\n<br>\r\nHow is the current support for mobile devices like the iPad? It would be perfect if I could edit on the road all my stuff. <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\">",
            "ownReply": false
        },
        {
            "author": "creator1988",
            "date": "woensdag 11 juli 2012 23:28",
            "contentHtml": "<blockquote><div class=\"quote\"><a href=\"http://glamour.tweakblogs.net/blog/8051/building-wordpress-sites-in-the-cloud.html#r_110568\">truegrit schreef op woensdag 11 juli 2012 @ 19:32:</a><br>\r\nI fiddled with c9 in the past for a bit, but i was unaware it had so much possibilities. I shall have to try it out some day</div></blockquote><blockquote><div class=\"quote\"><a href=\"http://glamour.tweakblogs.net/blog/8051/building-wordpress-sites-in-the-cloud.html#r_110570\">Vold schreef op woensdag 11 juli 2012 @ 20:16:</a><br>\r\nI didn&apos;t knew you could deploy php apps to Heroku with such ease! I used cloud9 a while ago, but I thought it was too buggy back then, I looks way more stable now!</div></blockquote>Great! We&apos;ve made some incredible improvements in the past week, so I&apos;d love to hear your feedback.<blockquote><div class=\"quote\">How is the current support for mobile devices like the iPad? It would be perfect if I could edit on the road all my stuff. <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\"></div></blockquote>Tablet device support is not in there at the moment, can&apos;t give a timeline for it either a.t.m. But it&apos;s something that&apos;ll definitely land in the near future.",
            "ownReply": true
        }
    ]
}