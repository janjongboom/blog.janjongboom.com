{
    "title": "Intelligente suggesties, deel 3: Uitspraak en hierarchie",
    "language": "nl",
    "link": "http://glamour.tweakblogs.net/blog/5849/intelligente-suggesties-deel-3-uitspraak-en-hierarchie.html",
    "date": "2010-12-29T14:05:00.000Z",
    "category": "Algoritmes",
    "views": 3616,
    "articleHtml": "Dit is deel 3 in een serie over de techniek uit een &apos;intelligente&apos; zoekbox.<ul><li><a href=\"http://glamour.tweakblogs.net/blog/5832/intelligente-suggesties-deel-1-introductie-en-startswith.html\" rel=\"external\">1. Introductie en &apos;StartsWith&apos;</a></li><li><a href=\"http://glamour.tweakblogs.net/blog/5842/intelligente-suggesties-deel-2-volledige-matching-en-typfouten.html\" rel=\"external\">2. Volledige matching en typfouten</a></li><li><b>3. Uitspraak en hierarchie</b></li><li><a href=\"http://glamour.tweakblogs.net/blog/5853/intelligente-suggesties-deel-4-aantallen-caching-en-protocol-buffers.html\" rel=\"external\">4. Aantallen, caching en Protocol Buffers</a></li></ul>Na gisteren een BK-tree gemaakt te hebben waarmee we kunnen zoeken op woorden, en daarbij ook typfouten kunnen ondervangen, verbeteren we dit vandaag door middel van een combinatie van het fonetisch algoritme <a href=\"http://glamour.tweakblogs.net/blog/5732/diakritische-tekens-en-soundex-in-net.html\" rel=\"external\">Soundex</a> en de Burkhard-Keller tree.<br><a name=\"more\"></a><br>\r\n<b>In een boom opslaan van de Soundex waardes</b><br>\r\nVoor het opslaan van de Soundex waarde doe ik hetzelfde als gisteren voor de normale waardes; we gebruiken dus weer Levenshtein om de distance op te slaan. We kunnen dan gelijkklinkende woorden vinden door een query uit te voeren op de tree:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_ident\">var</span>&#xA0;<span class=\"code_ident\">list</span>&#xA0;=&#xA0;<span class=\"code_ident\">SoundexRootNode</span>.<span class=\"code_method\">Query</span>(<span class=\"code_string\">&quot;wiboudstraat&quot;</span>,&#xA0;<span class=\"code_number\">0</span>);&#xA0;<span class=\"code_comment\">//&#xA0;Wibautstraat,&#xA0;Amsterdam&#xA0;gevonden</span></code></div></td></tr></table><br>\r\nNu kunnen we meerdere dingen doen om fouten in zowel spelling als uitspraak te vinden:<ul><li>Alleen zoeken op soundex van de invoer van de gebruiker</li><li>Alle woorden vinden met een distance van 1; en hier soundex op toepassen (als je &apos;Driese Wetering&apos; intikt, krijg je bijv. &apos;Drielse Wetering&apos;; op elk van deze resultaten doe je een query in de Soundex Tree)</li><li>Alle resultaten in de soundex vinden met een distance van 1 (&apos;Wiboukstraat&apos; resulteert in &apos;Wibautstraat&apos;)</li></ul>Het resultaat van elk van deze benaderingen varieert nogal per dataset, maar voor onze implementatie hebben we voorlopig gekozen voor 1., maar 2. staat nog ter discussie. De implementatie is immers verborgen in de BK-tree, en we kunnen dus makkelijk schakelen.<br>\r\n<br>\r\n<b>Hierarchisch zoeken</b><br>\r\nGebruikers kunnen met komma&apos;s zoeken op hierarchie:<br>\r\n<br>code:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><pre>1\n2\n3\n</pre></td><td class=\"phphighlightcode\"><div><pre>Pijp, Noord-Holland \r\n// vindt alleen alle entiteiten met naam &apos;Pijp&apos; in de provincie NH\r\n// dus niet &apos;Pijpenring&apos; in &apos;Delft&apos;</pre></div></td></tr></table><br>\r\nHierbij zijn twee problemen:<ul><li>Hoe vinden we hierarchie als de gebruiker geen komma&apos;s gebruikt; maar bijv. Pijp Amsterdam intikt?</li><li>Hoe vinden we snel en vooral effici&#xEB;nt de hierarchische parents?</li></ul><b>Geen komma&apos;s?</b><br>\r\nWanneer een gebruiker geen komma&apos;s gebruikt, zoeken we eerst naar resultaten die precies matchen (&apos;Pijp Amsterdam&apos;), als deze geen resultaten geeft, dan berekenen we alle mogelijke queries die we kunnen maken als we de spaties vervangen door komma&apos;s (in dit geval &apos;Pijp Amsterdam&apos; en &apos;Pijp,Amsterdam&apos;) met de volgende code:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_ident\">List</span>&lt;<span class=\"code_keyword\">string</span>&gt;&#xA0;<span class=\"code_method\">GetAllPossibleQueries</span>(<span class=\"code_keyword\">string</span>&#xA0;<span class=\"code_ident\">query</span>)\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">string</span>&#xA0;<span class=\"code_ident\">normalisedQuery</span>&#xA0;=&#xA0;<span class=\"code_ident\">query</span>.<span class=\"code_method\">Replace</span>(<span class=\"code_string\">&quot;,&quot;</span>,&#xA0;<span class=\"code_string\">&quot;&#xA0;&quot;</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">string</span>[]&#xA0;<span class=\"code_ident\">queryParts</span>&#xA0;=&#xA0;<span class=\"code_ident\">normalisedQuery</span>.<span class=\"code_method\">Split</span>(<span class=\"code_keyword\">new</span>[]&#xA0;{&#xA0;<span class=\"code_string\">&apos;&#xA0;&apos;</span>&#xA0;},&#xA0;<span class=\"code_ident\">StringSplitOptions</span>.<span class=\"code_ident\">RemoveEmptyEntries</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">normalisedQuery</span>&#xA0;=&#xA0;<span class=\"code_keyword\">string</span>.<span class=\"code_method\">Join</span>(<span class=\"code_string\">&quot;&#xA0;&quot;</span>,&#xA0;<span class=\"code_ident\">queryParts</span>);&#xA0;<span class=\"code_comment\">//&#xA0;1&#xA0;spatie&#xA0;is&#xA0;goed</span>\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">List</span>&lt;<span class=\"code_keyword\">string</span>&gt;&#xA0;<span class=\"code_ident\">queries</span>&#xA0;=&#xA0;<span class=\"code_keyword\">new</span>&#xA0;<span class=\"code_ident\">List</span>&lt;<span class=\"code_keyword\">string</span>&gt;();\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">int</span>[]&#xA0;<span class=\"code_ident\">spacePositions</span>&#xA0;=&#xA0;<span class=\"code_keyword\">new</span>&#xA0;<span class=\"code_keyword\">int</span>[<span class=\"code_ident\">queryParts</span>.<span class=\"code_ident\">Length</span>&#xA0;-&#xA0;<span class=\"code_number\">1</span>];\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">int</span>&#xA0;<span class=\"code_ident\">lixSpace</span>&#xA0;=&#xA0;<span class=\"code_number\">-1</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">for</span>(<span class=\"code_keyword\">int</span>&#xA0;<span class=\"code_ident\">ix</span>&#xA0;=&#xA0;<span class=\"code_number\">0</span>;&#xA0;<span class=\"code_ident\">ix</span>&#xA0;&lt;&#xA0;<span class=\"code_ident\">spacePositions</span>.<span class=\"code_ident\">Length</span>;&#xA0;<span class=\"code_ident\">ix</span>++)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">lixSpace</span>&#xA0;=&#xA0;<span class=\"code_ident\">normalisedQuery</span>.<span class=\"code_method\">IndexOf</span>(<span class=\"code_string\">&apos;&#xA0;&apos;</span>,&#xA0;<span class=\"code_ident\">lixSpace</span>&#xA0;+&#xA0;<span class=\"code_number\">1</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">spacePositions</span>[<span class=\"code_ident\">ix</span>]&#xA0;=&#xA0;<span class=\"code_ident\">lixSpace</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">var</span>&#xA0;<span class=\"code_ident\">powerSet</span>&#xA0;=&#xA0;<span class=\"code_method\">GetPowerSet</span>(<span class=\"code_ident\">spacePositions</span>.<span class=\"code_method\">ToList</span>());\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;order&#xA0;de&#xA0;powerset&#xA0;zo&#xA0;dat&#xA0;eerst&#xA0;de&#xA0;minste&#xA0;queries&#xA0;van&#xA0;achter&#xA0;naar&#xA0;voor</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;dus&#xA0;Drielse&#xA0;Wetering,&#xA0;Zaandam&#xA0;komt&#xA0;voor&#xA0;Drielse,&#xA0;Wetering,&#xA0;Zaandam</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">powerSet</span>&#xA0;=&#xA0;<span class=\"code_ident\">powerSet</span>.<span class=\"code_method\">OrderBy</span>(<span class=\"code_ident\">i</span>&#xA0;=&gt;&#xA0;<span class=\"code_ident\">i</span>.<span class=\"code_method\">Count</span>()).<span class=\"code_method\">ThenByDescending</span>(<span class=\"code_ident\">i</span>&#xA0;=&gt;&#xA0;<span class=\"code_ident\">i</span>.<span class=\"code_method\">Sum</span>());\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">foreach</span>(<span class=\"code_ident\">var</span>&#xA0;<span class=\"code_ident\">set</span>&#xA0;<span class=\"code_keyword\">in</span>&#xA0;<span class=\"code_ident\">powerSet</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">char</span>[]&#xA0;<span class=\"code_ident\">newQuery</span>&#xA0;=&#xA0;<span class=\"code_ident\">normalisedQuery</span>.<span class=\"code_method\">ToCharArray</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">foreach</span>(<span class=\"code_ident\">var</span>&#xA0;<span class=\"code_ident\">space</span>&#xA0;<span class=\"code_keyword\">in</span>&#xA0;<span class=\"code_ident\">set</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">newQuery</span>[<span class=\"code_ident\">space</span>]&#xA0;=&#xA0;<span class=\"code_string\">&apos;,&apos;</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">queries</span>.<span class=\"code_method\">Add</span>(<span class=\"code_keyword\">new</span>&#xA0;<span class=\"code_keyword\">string</span>(<span class=\"code_ident\">newQuery</span>));\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_ident\">queries</span>.<span class=\"code_method\">Where</span>(<span class=\"code_ident\">q</span>=&gt;!<span class=\"code_ident\">q</span>.<span class=\"code_method\">Equals</span>(<span class=\"code_ident\">normalisedQuery</span>,&#xA0;<span class=\"code_ident\">StringComparison</span>.<span class=\"code_ident\">Ordinal</span>)).<span class=\"code_method\">ToList</span>();\n<br>}\n<br>\n<br><span class=\"code_comment\">//&#xA0;http://social.msdn.microsoft.com/Forums/en-CA/netfxbcl/thread/42375146-eade-43ae-9550-1dfdd7c8aa18</span>\n<br><span class=\"code_keyword\">private</span>&#xA0;<span class=\"code_ident\">IEnumerable</span>&lt;<span class=\"code_ident\">IEnumerable</span>&lt;<span class=\"code_ident\">T</span>&gt;&gt;&#xA0;<span class=\"code_ident\">GetPowerSet</span>&lt;<span class=\"code_ident\">T</span>&gt;(<span class=\"code_ident\">List</span>&lt;<span class=\"code_ident\">T</span>&gt;&#xA0;<span class=\"code_ident\">list</span>)\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_ident\">from</span>&#xA0;<span class=\"code_ident\">m</span>&#xA0;<span class=\"code_keyword\">in</span>&#xA0;<span class=\"code_ident\">Enumerable</span>.<span class=\"code_method\">Range</span>(<span class=\"code_number\">0</span>,&#xA0;<span class=\"code_number\">1</span>&#xA0;&lt;&lt;&#xA0;<span class=\"code_ident\">list</span>.<span class=\"code_ident\">Count</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">select</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">from</span>&#xA0;<span class=\"code_ident\">i</span>&#xA0;<span class=\"code_keyword\">in</span>&#xA0;<span class=\"code_ident\">Enumerable</span>.<span class=\"code_method\">Range</span>(<span class=\"code_number\">0</span>,&#xA0;<span class=\"code_ident\">list</span>.<span class=\"code_ident\">Count</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">where</span>&#xA0;(<span class=\"code_ident\">m</span>&#xA0;&amp;&#xA0;(<span class=\"code_number\">1</span>&#xA0;&lt;&lt;&#xA0;<span class=\"code_ident\">i</span>))&#xA0;!=&#xA0;<span class=\"code_number\">0</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">select</span>&#xA0;<span class=\"code_ident\">list</span>[<span class=\"code_ident\">i</span>];\n<br>}</code></div></td></tr></table><br>\r\nHierna voeren we alle mogelijke queries nog een keer uit.<br>\r\n<br>\r\n<b>Wel komma&apos;s</b><br>\r\nNa de eerste keer geen komma&apos;s gehad te hebben, parsen we de query (&apos;Pijp, Amsterdam&apos;) van de gebruiker naar dit model:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br></code></td><td class=\"phphighlightcode\"><div><code>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">class</span>&#xA0;<span class=\"code_ident\">Zoekhierarchisch</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">string</span>&#xA0;<span class=\"code_ident\">Term</span>&#xA0;{&#xA0;<span class=\"code_ident\">get</span>;<span class=\"code_ident\">set</span>;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_ident\">Zoekhierarchisch</span>&#xA0;<span class=\"code_ident\">Parent</span>&#xA0;{&#xA0;<span class=\"code_ident\">get</span>;<span class=\"code_ident\">set</span>;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;hier&#xA0;komt&#xA0;uit</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;{&#xA0;<span class=\"code_ident\">Term</span>:&#xA0;<span class=\"code_string\">&quot;Pijp&quot;</span>,&#xA0;<span class=\"code_ident\">Parent</span>:&#xA0;{&#xA0;<span class=\"code_ident\">Term</span>:&#xA0;<span class=\"code_string\">&quot;Amsterdam&quot;</span>,&#xA0;<span class=\"code_ident\">Parent</span>:&#xA0;<span class=\"code_keyword\">null</span>&#xA0;}&#xA0;}</code></div></td></tr></table><br>\r\nEn we zoeken nu met de standaard-zoekcode naar alles waar &apos;Pijp&apos; in voorkomt. Hieruit komt bijvoorbeeld &apos;Oude Pijp&apos;, &apos;Nieuwe Pijp&apos; en &apos;Pijperring&apos;. Omdat elk gebied een &apos;Parent&apos; property heeft, kunnen we dit gebruiken om te controleren of er ooit een parent is van het huidige gebied die matcht tegen de invoer van de gebruiker:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>61<br>62<br>63<br>64<br>65<br>66<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_ident\">List</span>&lt;<span class=\"code_ident\">GeoGebied</span>&gt;&#xA0;<span class=\"code_method\">FilterHierarchic</span>(<span class=\"code_ident\">IEnumerable</span>&lt;<span class=\"code_ident\">GeoGebied</span>&gt;&#xA0;<span class=\"code_ident\">gebieden</span>,&#xA0;<span class=\"code_ident\">Zoekhierarchisch</span>&#xA0;<span class=\"code_ident\">criterium</span>,&#xA0;<span class=\"code_keyword\">int</span>&#xA0;<span class=\"code_ident\">fuziness</span>,&#xA0;<span class=\"code_keyword\">bool</span>&#xA0;<span class=\"code_ident\">useSoundex</span>)\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;als&#xA0;de&#xA0;zoekopdracht&#xA0;geen&#xA0;parent&#xA0;heeft,&#xA0;dan&#xA0;matcht&#xA0;alles</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">criterium</span>.<span class=\"code_ident\">Parent</span>&#xA0;==&#xA0;<span class=\"code_keyword\">null</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_ident\">gebieden</span>.<span class=\"code_method\">ToList</span>();\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;maak&#xA0;een&#xA0;lijst&#xA0;met&#xA0;alle&#xA0;parents</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">List</span>&lt;<span class=\"code_keyword\">string</span>&gt;&#xA0;<span class=\"code_ident\">terms</span>&#xA0;=&#xA0;<span class=\"code_keyword\">new</span>&#xA0;<span class=\"code_ident\">List</span>&lt;<span class=\"code_keyword\">string</span>&gt;();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">var</span>&#xA0;<span class=\"code_ident\">cp</span>&#xA0;=&#xA0;<span class=\"code_ident\">criterium</span>.<span class=\"code_ident\">Parent</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">while</span>(<span class=\"code_keyword\">true</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">cp</span>&#xA0;==&#xA0;<span class=\"code_keyword\">null</span>)&#xA0;<span class=\"code_keyword\">break</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">terms</span>.<span class=\"code_method\">Add</span>(<span class=\"code_ident\">cp</span>.<span class=\"code_ident\">Term</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">cp</span>&#xA0;=&#xA0;<span class=\"code_ident\">cp</span>.<span class=\"code_ident\">Parent</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;als&#xA0;query&#xA0;was&#xA0;&apos;Drostendiep,&#xA0;Kalf,&#xA0;Zaandam&apos;&#xA0;dan&#xA0;terms&#xA0;is</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;[&#xA0;Kalf,&#xA0;Zaandam&#xA0;]</span>\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;we&#xA0;gaan&#xA0;nu&#xA0;van&#xA0;elk&#xA0;gebied&#xA0;in&#xA0;de&#xA0;set&#xA0;controleren&#xA0;of&#xA0;deze&#xA0;ooit&#xA0;matcht</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_ident\">gebieden</span>.<span class=\"code_method\">Where</span>(<span class=\"code_ident\">g</span>&#xA0;=&gt;&#xA0;<span class=\"code_method\">EverMatchesHierarchic</span>(<span class=\"code_ident\">g</span>,&#xA0;<span class=\"code_ident\">terms</span>,&#xA0;<span class=\"code_ident\">fuziness</span>,&#xA0;<span class=\"code_ident\">useSoundex</span>,&#xA0;<span class=\"code_number\">0</span>)).<span class=\"code_method\">ToList</span>();\n<br>}\n<br>\n<br><span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">bool</span>&#xA0;<span class=\"code_method\">EverMatchesHierarchic</span>(<span class=\"code_ident\">GeoGebied</span>&#xA0;<span class=\"code_ident\">gebied</span>,&#xA0;<span class=\"code_ident\">List</span>&lt;<span class=\"code_keyword\">string</span>&gt;&#xA0;<span class=\"code_ident\">terms</span>,&#xA0;<span class=\"code_keyword\">int</span>&#xA0;<span class=\"code_ident\">fuziness</span>,&#xA0;<span class=\"code_keyword\">bool</span>&#xA0;<span class=\"code_ident\">useSoundex</span>,&#xA0;<span class=\"code_keyword\">int</span>&#xA0;<span class=\"code_ident\">level</span>)\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">var</span>&#xA0;<span class=\"code_ident\">soundex</span>&#xA0;=&#xA0;<span class=\"code_keyword\">new</span>&#xA0;<span class=\"code_method\">Soundex</span>();\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;dit&#xA0;slaan&#xA0;we&#xA0;de&#xA0;eerste&#xA0;keer&#xA0;over&#xA0;want&#xA0;anders&#xA0;werkt&#xA0;utrecht,&#xA0;utrecht,&#xA0;utrecht&#xA0;niet&#xA0;meer&#xA0;correct</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;we&#xA0;moeten&#xA0;namelijk&#xA0;minimaal&#xA0;1&#xA0;niveau&#xA0;omhoog&#xA0;zijn&#xA0;gegaan</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(++<span class=\"code_ident\">level</span>&#xA0;&gt;&#xA0;<span class=\"code_number\">1</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;als&#xA0;het&#xA0;gebied&#xA0;NULL&#xA0;is,&#xA0;dan&#xA0;matcht&#xA0;dit&#xA0;natuurlijk&#xA0;niet</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">gebied</span>&#xA0;==&#xA0;<span class=\"code_keyword\">null</span>)&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_keyword\">false</span>;\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">bool</span>&#xA0;<span class=\"code_ident\">success</span>&#xA0;=&#xA0;<span class=\"code_keyword\">false</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">string</span>&#xA0;<span class=\"code_ident\">terms0Soundex</span>&#xA0;=&#xA0;<span class=\"code_ident\">useSoundex</span>&#xA0;?&#xA0;<span class=\"code_ident\">soundex</span>.<span class=\"code_method\">Calculate</span>(<span class=\"code_ident\">terms</span>[<span class=\"code_number\">0</span>])&#xA0;:&#xA0;<span class=\"code_keyword\">null</span>;\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;een&#xA0;gebied&#xA0;kan&#xA0;meerdere&#xA0;keys&#xA0;hebben;&#xA0;want&#xA0;varianten&#xA0;enzo</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">foreach</span>(<span class=\"code_ident\">var</span>&#xA0;<span class=\"code_ident\">gebiedVariant</span>&#xA0;<span class=\"code_keyword\">in</span>&#xA0;<span class=\"code_ident\">LongCache</span>.<span class=\"code_ident\">IxGebiedId</span>[<span class=\"code_ident\">gebied</span>.<span class=\"code_ident\">Id</span>])\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;een&#xA0;gebied&#xA0;matcht&#xA0;als:</span>\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;1.&#xA0;zijn&#xA0;keys&#xA0;overeenkomt&#xA0;met&#xA0;terms[0]</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">gebiedVariant</span>.<span class=\"code_ident\">Keys</span>.<span class=\"code_method\">Any</span>(<span class=\"code_ident\">key</span>=&gt;<span class=\"code_ident\">key</span>.<span class=\"code_method\">Equals</span>(<span class=\"code_ident\">terms</span>[<span class=\"code_number\">0</span>],&#xA0;<span class=\"code_ident\">StringComparison</span>.<span class=\"code_ident\">Ordinal</span>)))&#xA0;<span class=\"code_ident\">success</span>&#xA0;=&#xA0;<span class=\"code_keyword\">true</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;2.&#xA0;zijn&#xA0;keys&#xA0;starts&#xA0;with&#xA0;terms[0]</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">else</span>&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">gebiedVariant</span>.<span class=\"code_ident\">Keys</span>.<span class=\"code_method\">Any</span>(<span class=\"code_ident\">key</span>=&gt;<span class=\"code_ident\">key</span>.<span class=\"code_method\">StartsWith</span>(<span class=\"code_ident\">terms</span>[<span class=\"code_number\">0</span>])))&#xA0;<span class=\"code_ident\">success</span>&#xA0;=&#xA0;<span class=\"code_keyword\">true</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;3.&#xA0;zijn&#xA0;soundexkeys&#xA0;overeenkomen&#xA0;met&#xA0;soundex&#xA0;van&#xA0;terms[0]</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">else</span>&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">useSoundex</span>&#xA0;&amp;&amp;&#xA0;<span class=\"code_ident\">gebiedVariant</span>.<span class=\"code_ident\">Keys</span>.<span class=\"code_method\">Any</span>(<span class=\"code_ident\">key</span>=&gt;<span class=\"code_ident\">soundex</span>.<span class=\"code_method\">Calculate</span>(<span class=\"code_ident\">key</span>)&#xA0;==&#xA0;<span class=\"code_ident\">terms0Soundex</span>))&#xA0;<span class=\"code_ident\">success</span>&#xA0;=&#xA0;<span class=\"code_keyword\">true</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;4.&#xA0;fuziness&#xA0;goed&#xA0;is</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">else</span>&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">fuziness</span>&#xA0;&gt;&#xA0;<span class=\"code_number\">0</span>&#xA0;&amp;&amp;&#xA0;<span class=\"code_ident\">gebiedVariant</span>.<span class=\"code_ident\">Keys</span>.<span class=\"code_method\">Any</span>(<span class=\"code_ident\">key</span>&#xA0;=&gt;&#xA0;<span class=\"code_ident\">EditDistance</span>.<span class=\"code_method\">YetiLevenshtein</span>(<span class=\"code_ident\">key</span>,&#xA0;<span class=\"code_ident\">terms</span>[<span class=\"code_number\">0</span>])&#xA0;&lt;=&#xA0;<span class=\"code_ident\">fuziness</span>))&#xA0;<span class=\"code_ident\">success</span>&#xA0;=&#xA0;<span class=\"code_keyword\">true</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">success</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;als&#xA0;dit&#xA0;de&#xA0;laatste&#xA0;term&#xA0;was&#xA0;dan&#xA0;true</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">terms</span>.<span class=\"code_ident\">Count</span>&#xA0;==&#xA0;<span class=\"code_number\">1</span>)&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_keyword\">true</span>;\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;anders&#xA0;halen&#xA0;we&#xA0;de&#xA0;huidige&#xA0;term&#xA0;eraf&#xA0;en&#xA0;zoeken&#xA0;we&#xA0;verder</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">terms</span>&#xA0;=&#xA0;<span class=\"code_ident\">terms</span>.<span class=\"code_method\">Skip</span>(<span class=\"code_number\">1</span>).<span class=\"code_method\">ToList</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;zoek&#xA0;in&#xA0;onze&#xA0;cache&#xA0;of&#xA0;we&#xA0;het&#xA0;parent-element&#xA0;van&#xA0;het&#xA0;huidige&#xA0;geoGebied&#xA0;wel&#xA0;kennen</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(!<span class=\"code_ident\">LongCache</span>.<span class=\"code_ident\">IxGebiedId</span>.<span class=\"code_method\">ContainsKey</span>(<span class=\"code_ident\">gebied</span>.<span class=\"code_ident\">Parent</span>))&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_keyword\">false</span>;\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_method\">EverMatchesHierarchic</span>(<span class=\"code_ident\">LongCache</span>.<span class=\"code_ident\">IxGebiedId</span>.<span class=\"code_method\">ContainsKey</span>(<span class=\"code_ident\">gebied</span>.<span class=\"code_ident\">Parent</span>)&#xA0;?&#xA0;<span class=\"code_ident\">LongCache</span>.<span class=\"code_ident\">IxGebiedId</span>[<span class=\"code_ident\">gebied</span>.<span class=\"code_ident\">Parent</span>].<span class=\"code_method\">FirstOrDefault</span>()&#xA0;:&#xA0;<span class=\"code_keyword\">null</span>,&#xA0;<span class=\"code_ident\">terms</span>,&#xA0;<span class=\"code_ident\">fuziness</span>,&#xA0;<span class=\"code_ident\">useSoundex</span>,&#xA0;<span class=\"code_ident\">level</span>);\n<br>}</code></div></td></tr></table><br>\r\nDe lijst is nu gefilterd, en &apos;Pijperring&apos; is verwijderd; daar deze in Delft ligt!<br>\r\n<br>\r\n<b>Morgen</b><br>\r\nHet laatste deel in deze serie: aantallen woningen, caching en Protocol Buffers.",
    "nextLink": "http://glamour.tweakblogs.net/blog/5842/intelligente-suggesties-deel-2-volledige-matching-en-typfouten.html",
    "comments": [
        {
            "author": "Battle Bunny",
            "date": "woensdag 29 december 2010 15:19",
            "contentHtml": "Erg leuke en boeiende serie so far, bedankt!<br>\r\n<br>\r\nIk heb meteen even die link gelezen over Power Sets, en ondanks dat het erg krachtig lijkt, vind ik dit:<blockquote><div class=\"quote\">private IEnumerable&lt;IEnumerable&lt;T&gt;&gt; GetPowerSet&lt;T&gt;(List&lt;T&gt; list)</div></blockquote>echt walgelijk om te lezen. Nu ben ik natuurlijk een VB.Net monkey en heb ik nog steeds een beetje moeite met C en C# syntax, maar dit slaat alles <img src=\"http://tweakimg.net/g/s/wink.gif\" width=\"15\" height=\"15\" alt=\";)\">",
            "ownReply": false
        },
        {
            "author": "creator1988",
            "date": "woensdag 29 december 2010 15:27",
            "contentHtml": "<blockquote><div class=\"quote\"><a href=\"http://glamour.tweakblogs.net/blog/5849/intelligente-suggesties-deel-3-uitspraak-en-hierarchie.html#r_78358\">Battle Bunny schreef op woensdag 29 december 2010 @ 15:19:</a><br>\r\nErg leuke en boeiende serie so far, bedankt!</div></blockquote>Grazie!<blockquote><div class=\"quote\">echt walgelijk om te lezen. Nu ben ik natuurlijk een VB.Net monkey en heb ik nog steeds een beetje moeite met C en C# syntax, maar dit slaat alles <img src=\"http://tweakimg.net/g/s/wink.gif\" width=\"15\" height=\"15\" alt=\";)\"></div></blockquote>Beter zo?<br>\r\n<br>Visual Basic .NET:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">Private</span>&#xA0;<span class=\"code_keyword\">Function</span>&#xA0;<span class=\"code_method\">GetPowerSet</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_ident\">T</span>)(<span class=\"code_ident\">list</span>&#xA0;<span class=\"code_keyword\">As</span>&#xA0;<span class=\"code_method\">List</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_ident\">T</span>))&#xA0;<span class=\"code_keyword\">As</span>&#xA0;<span class=\"code_method\">IEnumerable</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_method\">IEnumerable</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_ident\">T</span>))</code></div></td></tr></table>",
            "ownReply": true
        },
        {
            "author": "Battle Bunny",
            "date": "woensdag 29 december 2010 21:23",
            "contentHtml": "<blockquote><div class=\"quote\">Grazie!</div></blockquote>Enige punt is nu dat mijn vingers jeuken om dit ergens in onze software te implementeren... Kan alleen nog geen geschikte plek vinden <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":p\"><blockquote><div class=\"quote\">Beter zo?<br>\r\n<br>Visual Basic .NET:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">Private</span>&#xA0;<span class=\"code_keyword\">Function</span>&#xA0;<span class=\"code_method\">GetPowerSet</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_ident\">T</span>)(<span class=\"code_ident\">list</span>&#xA0;<span class=\"code_keyword\">As</span>&#xA0;<span class=\"code_method\">List</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_ident\">T</span>))&#xA0;<span class=\"code_keyword\">As</span>&#xA0;<span class=\"code_method\">IEnumerable</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_method\">IEnumerable</span>(<span class=\"code_ident\">Of</span>&#xA0;<span class=\"code_ident\">T</span>))</code></div></td></tr></table></div></blockquote>Leest voor mij iets beter, maar nog steeds een erg ... euhm ... leuke oplossing <img src=\"http://tweakimg.net/g/s/wink.gif\" width=\"15\" height=\"15\" alt=\";)\"><br>\r\n<br>\r\nIk neem trouwens aan dat deze blog entries ook wel op een grote programmeer-kennis-dump-site komen? Zou zonde zijn als dit niet meer te vinden is of niet meer gelezen wordt puur omdat te weinig mensen op de tweakblogs komen!",
            "ownReply": false
        },
        {
            "author": "RobIII",
            "date": "woensdag 29 december 2010 21:36",
            "contentHtml": "<div class=\"edit\">edit:<br>nvm. Hier stond (dikke) onzin <img src=\"http://tweakimg.net/g/s/shutup.gif\" width=\"15\" height=\"16\" alt=\":X\"> </div><p class=\"edit\">[Reactie gewijzigd op donderdag 30 december 2010 03:02]</p>",
            "ownReply": false
        },
        {
            "author": "FlowinG",
            "date": "woensdag 29 december 2010 23:34",
            "contentHtml": "@RobIII<br>\r\n<br>\r\nHet lijkt mij een stuk optimalisatie om het juist niet te doen: op het moment dat de gebruiker komma&apos;s gebruikt hoef je niet &apos;slimmer&apos; te gaan doen dan de gebruiker en ook niet onnodig hierarchisch te zoeken. Verder zullen komma&apos;s ook problemen geven bij het zoeken naar &quot;den haag&quot; of &quot;krimpen aan de ijssel&quot;.",
            "ownReply": false
        },
        {
            "author": "RobIII",
            "date": "donderdag 30 december 2010 01:19",
            "contentHtml": "Ja dat bedacht ik later ook <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":P\"> Sowieso een duf moment gehad; want dan waren die komma&apos;s helemaal overbodig geweest en had je net zo goed kunnen splitten op spaties <img src=\"http://tweakimg.net/g/s/shutup.gif\" width=\"15\" height=\"16\" alt=\":X\"><br>\r\nKerstdufheid zullen we maar zeggen <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":P\"><p class=\"edit\">[Reactie gewijzigd op donderdag 30 december 2010 02:46]</p>",
            "ownReply": false
        },
        {
            "author": "-RetroX-",
            "date": "donderdag 30 december 2010 08:59",
            "contentHtml": "Hoe is de efficiency als een term in meerdere levels voorkomt?<br>\r\n<br>\r\n&quot;De Groningerstraatweg Groningen (Groningen)&quot;  [deze straat ligt in Leeuwarden maar zo is het voorbeeld leuker ;) ]",
            "ownReply": false
        },
        {
            "author": "creator1988",
            "date": "donderdag 30 december 2010 10:13",
            "contentHtml": "<blockquote><div class=\"quote\"><a href=\"http://glamour.tweakblogs.net/blog/5849/intelligente-suggesties-deel-3-uitspraak-en-hierarchie.html#r_78381\">RobIII schreef op donderdag 30 december 2010 @ 01:19:</a><br>\r\nJa dat bedacht ik later ook <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":P\"> Sowieso een duf moment gehad; want dan waren die komma&apos;s helemaal overbodig geweest en had je net zo goed kunnen splitten op spaties <img src=\"http://tweakimg.net/g/s/shutup.gif\" width=\"15\" height=\"16\" alt=\":X\"><br>\r\nKerstdufheid zullen we maar zeggen <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":P\"></div></blockquote>Niet helemaal onzin; het ligt eraan hoe je verwacht dat je gebruikers gaan invoeren. Wij nemen aan dat de gebruiker het in de meeste gevallen correct invoert, en dus houden we de zoekterm eerst intact. Verwacht je dat je veel 1-woords termen hebt waarbij de gebruiker altijd spaties i.p.v. komma&apos;s gebruikt kan je de set andersom evalueren.<blockquote><div class=\"quote\"><a href=\"http://glamour.tweakblogs.net/blog/5849/intelligente-suggesties-deel-3-uitspraak-en-hierarchie.html#r_78385\">-RetroX- schreef op donderdag 30 december 2010 @ 08:59:</a><br>\r\nHoe is de efficiency als een term in meerdere levels voorkomt?<br>\r\n<br>\r\n&quot;De Groningerstraatweg Groningen (Groningen)&quot;  [deze straat ligt in Leeuwarden maar zo is het voorbeeld leuker ;) ]</div></blockquote>Hoe meer termen hoe minder effici&#xEB;nt; of de termen hetzelfde zijn maakt hiervoor niet uit. Ter info: de term &apos;utrecht utrecht utrecht utrecht utrecht&apos; (de langste die we hebben: Utrechtseweg in de plaats Utrecht, in de gemeente Utrecht, in de regio Utrecht, in de provincie Utrecht) wordt uitgevoerd (zonder komma&apos;s) in 10 ms. Met komma&apos;s in 4 ms. Dus ja wordt wel trager maar niet schokkend.<blockquote><div class=\"quote\"><a href=\"http://glamour.tweakblogs.net/blog/5849/intelligente-suggesties-deel-3-uitspraak-en-hierarchie.html#r_78372\">Battle Bunny schreef op woensdag 29 december 2010 @ 21:23:</a><br>\r\nIk neem trouwens aan dat deze blog entries ook wel op een grote programmeer-kennis-dump-site komen? Zou zonde zijn als dit niet meer te vinden is of niet meer gelezen wordt puur omdat te weinig mensen op de tweakblogs komen!</div></blockquote>Google waardeert over het algemeen mijn stukjes wel; dus vooralsnog vind ik dat wel genoeg. Zoek maar op &apos;bk tree c#&apos;; sta op plek 3 en plek 4 als je vanuit Nederland zoekt  <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\"> .<p class=\"edit\">[Reactie gewijzigd op donderdag 30 december 2010 10:17]</p>",
            "ownReply": true
        }
    ]
}