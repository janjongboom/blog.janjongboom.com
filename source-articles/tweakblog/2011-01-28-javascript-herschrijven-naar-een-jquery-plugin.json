{
    "title": "Javascript herschrijven naar een jQuery plugin",
    "language": "nl",
    "link": "http://glamour.tweakblogs.net/blog/6020/javascript-herschrijven-naar-een-jquery-plugin.html",
    "date": "2011-01-28T12:04:00.000Z",
    "category": "Frontend",
    "views": 4091,
    "articleHtml": "Wanneer het op &apos;normale&apos; backendcode aankomt is refactoring en het opnieuw schrijven van delen code welhaast een routineklus geworden. JavaScript is daarin wat lastiger; scoping is minder transparant, dus je breekt eenvoudig bestaande code die wellicht niets te maken heeft met jouw deel; en de flexibiliteit kan tegen je gaan werken. Vandaar een artikel over de wondere wereld van het herschrijven van de JavaScript voor de footer op funda!<br>\r\n<img src=\"http://www.100procentjan.nl/tweakers/viafunda.png\" title=\"http://www.100procentjan.nl/tweakers/viafunda.png\" alt=\"http://www.100procentjan.nl/tweakers/viafunda.png\"><br><a name=\"more\"></a><br>\r\n<b>Eisen</b><ul><li>Zoeken in het aanbod op funda, funda in business en funda landelijk</li><li>Afhankelijk van de categorie staat er een textbox, een lijst met provincies, of een lijst met regio&apos;s</li><li>Backend code herschrijven we niet</li></ul><b>Huidige situatie</b><br>\r\nDe huidige code voor de footer is <a href=\"http://pastebin.com/LfXQmvD5\" rel=\"external\">als volgt</a>. Key element hierin is de &apos;SoortAanbod&apos; enum die bij ons in code staat:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">enum</span>&#xA0;<span class=\"code_ident\">SoortAanbod</span>\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">Koop</span>:&#xA0;<span class=\"code_number\">10</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">Huur</span>:&#xA0;<span class=\"code_number\">11</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;etc.</span>\n<br>}</code></div></td></tr></table><br>\r\nDe dropdownlist met categorie-selectie is een directe mapping van deze enum:<br>\r\n<br>HTML:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_ident\">&lt;select</span>&#xA0;<span class=\"code_method\">class</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">type-via-funda</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">id</span>=<span class=\"code_string\">&quot;dropSubType&quot;</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;optgroup</span>&#xA0;<span class=\"code_method\">label</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">Woningaanbod</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;option</span>&#xA0;<span class=\"code_method\">value</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">10</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">selected</span>=<span class=\"code_string\">&quot;selected&quot;</span><span class=\"code_ident\">&gt;</span>Koopwoningen<span class=\"code_ident\">&lt;/option</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;option</span>&#xA0;<span class=\"code_method\">value</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">11</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span>Huurwoningen<span class=\"code_ident\">&lt;/option</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;option</span>&#xA0;<span class=\"code_method\">value</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">12</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span>Nieuwbouwprojecten<span class=\"code_ident\">&lt;/option</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;/optgroup</span><span class=\"code_ident\">&gt;</span>\n<br><span class=\"code_ident\">&lt;/select</span><span class=\"code_ident\">&gt;</span></code></div></td></tr></table><br>\r\nIn de JavaScript wordt er weer met deze id&apos;s gewerkt voor het tonen van de verschillende input-mogelijkheden (vanaf regel 86):<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">cs</span>&#xA0;=&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#dropSubType&apos;</span>).<span class=\"code_method\">val</span>();\n<br><span class=\"code_keyword\">switch</span>&#xA0;(<span class=\"code_ident\">cs</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_string\">&apos;10&apos;</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_string\">&apos;11&apos;</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#ppcplaats&apos;</span>).<span class=\"code_method\">show</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;toon&#xA0;&lt;input&#xA0;type=text/&gt;</span>\n<br>}</code></div></td></tr></table><br>\r\nDe input-elementen staan altijd op de pagina, en worden met &apos;display: none&apos; onzichtbaar gemaakt als ze niet mogelijk zijn qua selectie.<br>\r\n<br>HTML:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_ident\">&lt;p</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_special\">&lt;!</span><span class=\"code_comment\">--&#xA0;textbox&#xA0;--</span><span class=\"code_special\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;input</span>&#xA0;<span class=\"code_method\">type</span>=<span class=\"code_string\">&quot;text&quot;</span>&#xA0;<span class=\"code_method\">title</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">Plaatsnaam&#xA0;-of-&#xA0;postcode</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method_unknown\">placeholder</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">Plaatsnaam&#xA0;-of-&#xA0;postcode</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">value</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">class</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">input-via-funda</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">id</span>=<span class=\"code_string\">&quot;ppcplaats&quot;</span>&#xA0;<span class=\"code_method_unknown\">autocomplete</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">off</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">style</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">display:&#xA0;block;&#xA0;</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_special\">&lt;!</span><span class=\"code_comment\">--&#xA0;landen&#xA0;voor&#xA0;europees&#xA0;aanbod&#xA0;--</span><span class=\"code_special\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;select</span>&#xA0;<span class=\"code_method\">class</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">select-via-funda</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">id</span>=<span class=\"code_string\">&quot;land&quot;</span>&#xA0;<span class=\"code_method\">name</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">land</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">style</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">display:&#xA0;none;&#xA0;</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span><span class=\"code_ident\">&lt;/select</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_special\">&lt;!</span><span class=\"code_comment\">--&#xA0;regio&apos;s&#xA0;voor&#xA0;horeca&#xA0;--</span><span class=\"code_special\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;select</span>&#xA0;<span class=\"code_method\">class</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">select-via-funda</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">id</span>=<span class=\"code_string\">&quot;horegio&quot;</span>&#xA0;<span class=\"code_method\">name</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">horegio</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">style</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">display:&#xA0;none;&#xA0;</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span><span class=\"code_ident\">&lt;/select</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_special\">&lt;!</span><span class=\"code_comment\">--&#xA0;provincies&#xA0;--</span><span class=\"code_special\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;select</span>&#xA0;<span class=\"code_method\">class</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">select-via-funda</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">id</span>=<span class=\"code_string\">&quot;provincie&quot;</span>&#xA0;<span class=\"code_method\">name</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">provincie</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">style</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">display:&#xA0;none;&#xA0;</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span><span class=\"code_ident\">&lt;/select</span><span class=\"code_ident\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_special\">&lt;!</span><span class=\"code_comment\">--&#xA0;regio&apos;s&#xA0;voor&#xA0;landelijk&#xA0;aanbod&#xA0;--</span><span class=\"code_special\">&gt;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">&lt;select</span>&#xA0;<span class=\"code_method\">class</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">select-via-funda</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">id</span>=<span class=\"code_string\">&quot;landelijk&quot;</span>&#xA0;<span class=\"code_method\">name</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">landelijk</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">style</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">display:&#xA0;none;&#xA0;</span><span class=\"code_string\">&quot;</span><span class=\"code_ident\">&gt;</span><span class=\"code_ident\">&lt;/select</span><span class=\"code_ident\">&gt;</span>\n<br><span class=\"code_ident\">&lt;/p</span><span class=\"code_ident\">&gt;</span></code></div></td></tr></table><br>\r\n<br>\r\n<b>Huidige situatie op de server</b><br>\r\n<i>Ja, dit is bad-practice; maar dit artikel gaat over het herschrijven van JavaScript, we houden de werking dus intact</i>.<br>\r\nBij elke aanpassing in tekst, dropdown-waarde, etc. wordt een hidden field bijgewerkt:<br>\r\n<br>HTML:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_ident\">&lt;input</span>&#xA0;<span class=\"code_method\">type</span>=<span class=\"code_string\">&quot;hidden&quot;</span>&#xA0;<span class=\"code_method\">value</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">0</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">class</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">viaSearchKey</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">name</span>=<span class=\"code_string\">&quot;</span><span class=\"code_string\">viaSearch</span><span class=\"code_string\">&quot;</span>&#xA0;<span class=\"code_method\">id</span>=<span class=\"code_string\">&quot;viaSearch&quot;</span>&#xA0;<span class=\"code_special\">/</span><span class=\"code_ident_unknown\">&gt;</span></code></div></td></tr></table><br>\r\nIn dit hidden element moet de waarde als volgt worden opgemaakt:<br>\r\n<br>code:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><pre>1\n2\n3\n</pre></td><td class=\"phphighlightcode\"><div><pre>SoortAanbod | Waarde\r\nbv. 10|Amsterdam  voor koopaanbod in Amsterdam\r\nof    23|Utrecht  voor horeca in Utrecht</pre></div></td></tr></table><br>\r\n<br>\r\n<b>Herbouwen</b><br>\r\nWe gebruiken jQuery als onze core-library voor al onze JavaScript. Veel van onze componenten ontwikkelen we daarom ook als jQuery plugin: door de best-practices hierin te gebruiken worden veel problemen m.b.t. scoping opgelost.<br>\r\n<br>\r\nDe basis van de plugin:<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_comment\">//&#xA0;functie&#xA0;die&#xA0;direct&#xA0;wordt&#xA0;aangeroepen</span>\n<br>(<span class=\"code_keyword\">function</span>&#xA0;(<span class=\"code_ident\">$</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;$&#xA0;===&#xA0;jQuery&#xA0;op&#xA0;dit&#xA0;moment;&#xA0;snellere&#xA0;syntax</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;we&#xA0;gaan&#xA0;jQuery.protoype&#xA0;uitbreiden.&#xA0;Deze&#xA0;is&#xA0;gemapt&#xA0;op&#xA0;$.fn</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">$</span>.<span class=\"code_ident\">fn</span>.<span class=\"code_method\">extend</span>({\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;nieuwe&#xA0;plugin&#xA0;heet&#xA0;&apos;viaFunda&apos;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;&apos;opts&apos;&#xA0;argument&#xA0;voor&#xA0;het&#xA0;meegeven&#xA0;van&#xA0;options</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">viaFunda</span>:&#xA0;<span class=\"code_keyword\">function</span>&#xA0;(<span class=\"code_ident\">opts</span>){\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;this&#xA0;is&#xA0;een&#xA0;jQuery&#xA0;object&#xA0;hier</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;we&#xA0;gaan&#xA0;voor&#xA0;elk&#xA0;element&#xA0;in&#xA0;de&#xA0;set&#xA0;de&#xA0;plugin&#xA0;uitvoeren</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_keyword\">this</span>.<span class=\"code_method\">each</span>(<span class=\"code_keyword\">function</span>&#xA0;()&#xA0;{&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;magic!</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;});\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;});\n<br>})(<span class=\"code_ident\">jQuery</span>);</code></div></td></tr></table><br>\r\n<br>\r\nAllereerst hebben we een lijst met alle controls nodig, door deze strong te mappen is de kans op fouten kleiner:<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_keyword\">this</span>.<span class=\"code_method\">each</span>(<span class=\"code_keyword\">function</span>&#xA0;()&#xA0;{&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;in&#xA0;options&#xA0;zetten&#xA0;we&#xA0;de&#xA0;&apos;standaard&apos;&#xA0;waardes</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">options</span>&#xA0;=&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">controls</span>:&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">type</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#dropSubType&apos;</span>),\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">vrijeInvoer</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#ppcplaats&apos;</span>),\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">landen</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#land&apos;</span>),\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">horecaRegios</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#horegio&apos;</span>),\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">provincies</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#provincie&apos;</span>),\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">landelijkRegios</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#landelijk&apos;</span>),\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">magicElement</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#viaSearch&apos;</span>),\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">form</span>:&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_keyword\">this</span>).<span class=\"code_method\">closest</span>(<span class=\"code_string\">&apos;form&apos;</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;};\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;options&#xA0;kunnen&#xA0;overschreven&#xA0;worden&#xA0;via&#xA0;&apos;opts&apos;&#xA0;argument</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;dus&#xA0;gaan&#xA0;we&#xA0;ze&#xA0;samenvoegen,&#xA0;waar&#xA0;&apos;opts&apos;&#xA0;voorrang&#xA0;heeft</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">$</span>.<span class=\"code_method\">extend</span>(<span class=\"code_keyword\">true</span>,&#xA0;<span class=\"code_ident\">options</span>,&#xA0;<span class=\"code_ident\">opts</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;options&#xA0;bevat&#xA0;nu&#xA0;ook&#xA0;de&#xA0;waardes&#xA0;uit&#xA0;&apos;opts&apos;</span>\n<br>}</code></div></td></tr></table><br>\r\n<br>\r\nOok willen we af van de gehardcode waardes van de enum in code, dus maken we de enum na. JavaScript kent geen &apos;enum&apos; velden, maar eigenlijk zijn ze sowieso zwaar overrated:<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">typeEnum</span>&#xA0;=&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">wonen</span>:&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">koop</span>:&#xA0;<span class=\"code_number\">10</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">huur</span>:&#xA0;<span class=\"code_number\">11</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">nieuwbouw</span>:&#xA0;<span class=\"code_number\">12</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">recreatie</span>:&#xA0;<span class=\"code_number\">13</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">europe</span>:&#xA0;<span class=\"code_number\">14</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;},\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">business</span>:&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">kantoor</span>:&#xA0;<span class=\"code_number\">20</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">bedrijfshal</span>:&#xA0;<span class=\"code_number\">21</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">winkel</span>:&#xA0;<span class=\"code_number\">22</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">horeca</span>:&#xA0;<span class=\"code_number\">23</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">bouwgrond</span>:&#xA0;<span class=\"code_number\">24</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">overige</span>:&#xA0;<span class=\"code_number\">25</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;},\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">landelijk</span>:&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">woningen</span>:&#xA0;<span class=\"code_number\">111</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">agrarischeBedrijven</span>:&#xA0;<span class=\"code_number\">205</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">losseGrond</span>:&#xA0;<span class=\"code_number\">102</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>};</code></div></td></tr></table><br>\r\n<br>\r\n<b>Events afvangen</b><br>\r\nHet belangrijkste event dat we willen afvangen, is het moment dat iemand de waarde in de dropdown verandert.<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_comment\">//&#xA0;events&#xA0;die&#xA0;we&#xA0;willen&#xA0;afhandelen</span>\n<br><span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">initEvents</span>&#xA0;=&#xA0;<span class=\"code_keyword\">function</span>&#xA0;()&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;bind&#xA0;de&#xA0;functie&#xA0;aan&#xA0;het&#xA0;&apos;change&apos;&#xA0;event</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;roep&#xA0;deze&#xA0;meteen&#xA0;aan&#xA0;om&#xA0;de&#xA0;initial&#xA0;weergave&#xA0;goed&#xA0;te&#xA0;zetten</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">type</span>.<span class=\"code_method\">change</span>(<span class=\"code_ident\">typeDropdownChanged</span>).<span class=\"code_method\">change</span>();\n<br>};\n<br>\n<br><span class=\"code_comment\">//&#xA0;event&#xA0;-&#xA0;dropdownlist&#xA0;is&#xA0;veranderd</span>\n<br><span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">typeDropdownChanged</span>&#xA0;=&#xA0;<span class=\"code_keyword\">function</span>&#xA0;(<span class=\"code_ident\">ev</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;pak&#xA0;de&#xA0;waarde&#xA0;uit&#xA0;de&#xA0;type-dropdownlist</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">selectedType</span>&#xA0;=&#xA0;<span class=\"code_method\">Number</span>(<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">type</span>.<span class=\"code_method\">val</span>());\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;het&#xA0;nieuwe&#xA0;control&#xA0;dat&#xA0;we&#xA0;gaan&#xA0;tonen</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">ctrl</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;hee,&#xA0;dat&#xA0;lijkt&#xA0;verdomd&#xA0;veel&#xA0;op&#xA0;C#</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">switch</span>(<span class=\"code_ident\">selectedType</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_ident\">typeEnum</span>.<span class=\"code_ident\">wonen</span>.<span class=\"code_ident\">europe</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">ctrl</span>&#xA0;=&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">landen</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">break</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_ident\">typeEnum</span>.<span class=\"code_ident\">business</span>.<span class=\"code_ident\">overige</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_ident\">typeEnum</span>.<span class=\"code_ident\">business</span>.<span class=\"code_ident\">bouwgrond</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">ctrl</span>&#xA0;=&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">provincies</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">break</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_ident\">typeEnum</span>.<span class=\"code_ident\">business</span>.<span class=\"code_ident\">horeca</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">ctrl</span>&#xA0;=&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">horecaRegios</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">break</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_ident\">typeEnum</span>.<span class=\"code_ident\">landelijk</span>.<span class=\"code_ident\">agrarischeBedrijven</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_ident\">typeEnum</span>.<span class=\"code_ident\">landelijk</span>.<span class=\"code_ident\">woningen</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">case</span>&#xA0;<span class=\"code_ident\">typeEnum</span>.<span class=\"code_ident\">landelijk</span>.<span class=\"code_ident\">losseGrond</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">ctrl</span>&#xA0;=&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">landelijkRegios</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">break</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">default</span>:\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">ctrl</span>&#xA0;=&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">vrijeInvoer</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">break</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;hier&#xA0;gaan&#xA0;we&#xA0;echt&#xA0;switchen</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">switchType</span>(<span class=\"code_ident\">ctrl</span>);\n<br>};</code></div></td></tr></table><br>\r\n<br>\r\nGoede control tonen:<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_comment\">//&#xA0;ctrl&#xA0;is&#xA0;het&#xA0;control&#xA0;dat&#xA0;getoond&#xA0;moet&#xA0;worden</span>\n<br><span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">switchType</span>&#xA0;=&#xA0;<span class=\"code_keyword\">function</span>&#xA0;(<span class=\"code_ident\">ctrl</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;hide&#xA0;alle&#xA0;controls</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">vrijeInvoer</span>.<span class=\"code_method\">hide</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">landen</span>.<span class=\"code_method\">hide</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">horecaRegios</span>.<span class=\"code_method\">hide</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">provincies</span>.<span class=\"code_method\">hide</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">landelijkRegios</span>.<span class=\"code_method\">hide</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;en&#xA0;toon&#xA0;degene&#xA0;die&#xA0;echt&#xA0;zichtbaar&#xA0;moet&#xA0;worden</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">ctrl</span>.<span class=\"code_method\">show</span>();\n<br>};</code></div></td></tr></table><br>\r\n<br>\r\n<b>Hidden element setten</b><br>\r\nNu wordt weliswaar het juiste element zichtbaar, maar de waarde is nog niet zichtbaar. Daarvoor kunnen we inhaken op het &apos;submit&apos; event van ons formulier:<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">initEvents</span>&#xA0;=&#xA0;<span class=\"code_keyword\">function</span>&#xA0;()&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">type</span>.<span class=\"code_method\">change</span>(<span class=\"code_ident\">typeDropdownChanged</span>).<span class=\"code_method\">change</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;code&#xA0;die&#xA0;uitgevoerd&#xA0;wordt&#xA0;&apos;on&#xA0;submit&apos;</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">form</span>.<span class=\"code_method\">submit</span>(<span class=\"code_ident\">submitForm</span>);\n<br>};\n<br>\n<br><span class=\"code_comment\">//&#xA0;event&#xA0;-&#xA0;form&#xA0;wordt&#xA0;gesubmit</span>\n<br><span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">submitForm</span>&#xA0;=&#xA0;<span class=\"code_keyword\">function</span>&#xA0;(<span class=\"code_ident\">ev</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;hier&#xA0;gaan&#xA0;we&#xA0;magicElement&#xA0;setten</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;key&#xA0;begint&#xA0;met&#xA0;de&#xA0;waarde&#xA0;van&#xA0;de&#xA0;&apos;type&apos;&#xA0;dropdown</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">key</span>&#xA0;=&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">type</span>.<span class=\"code_method\">val</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">key</span>&#xA0;+=&#xA0;<span class=\"code_string\">&apos;|&apos;</span>;&#xA0;<span class=\"code_comment\">//&#xA0;pipe&#xA0;toevoegen</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;zoek&#xA0;op&#xA0;welk&#xA0;input&#xA0;element&#xA0;visible&#xA0;is</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">var</span>&#xA0;<span class=\"code_ident\">visibleElement</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;itereer&#xA0;over&#xA0;alle&#xA0;selectie-inputs&#xA0;en&#xA0;kijk&#xA0;welke&#xA0;zichtbaar&#xA0;is</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">$</span>([&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">vrijeInvoer</span>,&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">landen</span>,&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">horecaRegios</span>,&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">provincies</span>,&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">landelijkRegios</span>&#xA0;]).<span class=\"code_method\">each</span>(<span class=\"code_keyword\">function</span>&#xA0;(<span class=\"code_ident\">ix</span>,&#xA0;<span class=\"code_ident\">ele</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>(<span class=\"code_ident\">ele</span>.<span class=\"code_method\">is</span>(<span class=\"code_string\">&apos;:visible&apos;</span>))&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">visibleElement</span>&#xA0;=&#xA0;<span class=\"code_ident\">ele</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;});\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;voeg&#xA0;de&#xA0;waarde&#xA0;toe&#xA0;aan&#xA0;de&#xA0;key</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">key</span>&#xA0;+=&#xA0;<span class=\"code_ident\">visibleElement</span>.<span class=\"code_method\">val</span>();\n<br>&#xA0;&#xA0;&#xA0;&#xA0;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;en&#xA0;doe&#xA0;some&#xA0;magic</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">options</span>.<span class=\"code_ident\">controls</span>.<span class=\"code_ident\">magicElement</span>.<span class=\"code_method\">val</span>(<span class=\"code_ident\">key</span>);\n<br>};</code></div></td></tr></table><br>\r\n<br>\r\n<b>Et voila</b><br>\r\nWerking is hetzelfde gebleven, maar de code gebruikt nu geen global vars, magic numbers, etc. De logica voor de autosuggest is uit deze plugin gehaald, want die heeft hier niets mee te maken. Wel hadden we nog een event nodig waaraan gebruikers van onze plugin konden subscriben, om zo dingen te veranderen aan de autosuggest-plugin. Je gebruikt de code ongeveer als volgt:<br>\r\n<br>JavaScript:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_method\">$</span>(<span class=\"code_special\">document</span>).<span class=\"code_method\">ready</span>(<span class=\"code_keyword\">function</span>&#xA0;()&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;roep&#xA0;de&#xA0;plugin&#xA0;aan</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#ftr-extra&apos;</span>).<span class=\"code_method\">viaFunda</span>({\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;event&#xA0;dat&#xA0;gevuurd&#xA0;wordt</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">events</span>:&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;als&#xA0;het&#xA0;type&#xA0;verandert</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">onTypeChanged</span>:&#xA0;<span class=\"code_keyword\">function</span>&#xA0;(<span class=\"code_ident\">aanbod</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;geef&#xA0;dit&#xA0;door&#xA0;aan&#xA0;de&#xA0;zoekbox</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#ppcplaats&apos;</span>).<span class=\"code_method\">zoekboxfrontend</span>(<span class=\"code_string\">&apos;soortaanbod&apos;</span>,&#xA0;<span class=\"code_ident\">aanbod</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;});\n<br>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;roep&#xA0;de&#xA0;autocomplete&#xA0;plugin&#xA0;aan</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_method\">$</span>(<span class=\"code_string\">&apos;#ppcplaats&apos;</span>).<span class=\"code_method\">zoekboxfrontend</span>({\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_string\">/*&#xA0;instellingen&#xA0;*/</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;});\n<br>});</code></div></td></tr></table><br>\r\n<br>\r\n<b>Hele plugin</b><br>\r\nDe hele plugin, inclusief het &apos;onTypeChanged&apos; event, is <a href=\"http://pastebin.com/tYyNg0nB\" rel=\"external\">hier te vinden</a>.",
    "nextLink": "http://glamour.tweakblogs.net/blog/6005/bouw-eens-een-api-met-wcf-deel-3-domain-entities-converteren-naar-api-entities.html",
    "comments": [
        {
            "author": "Phyxion",
            "date": "vrijdag 28 januari 2011 19:04",
            "contentHtml": "Nog geen reacties zie ik, misschien ook wel minder toepasselijk bij dit soort blogs maar keep posting <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\"> Mooie afwisseling tussen de grote hoeveelheid rommel van andere blogs <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\">",
            "ownReply": false
        },
        {
            "author": "chrashoverraid",
            "date": "vrijdag 28 januari 2011 19:48",
            "contentHtml": "Ik reageer niet altijd, maar lees het wel altijd <img src=\"http://tweakimg.net/g/s/wink.gif\" width=\"15\" height=\"15\" alt=\";)\"><br>\r\nThanks weer iig, blijft interessant om te zien hoe andere mensen dingen met code oplossen.",
            "ownReply": false
        },
        {
            "author": "mindcrash",
            "date": "zaterdag 29 januari 2011 00:27",
            "contentHtml": "Volgens mij mag/kun je je plugin definitie ook starten met:<br>\r\n<br>\r\n$.fn.myPlugin = function(options) {<br>\r\n}<br>\r\n<br>\r\ntrouwens <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\"><br>\r\n<br>\r\n(zie bijvoorbeeld de docs en de plugin template van Mike Alsup op learningjquery)<p class=\"edit\">[Reactie gewijzigd op zaterdag 29 januari 2011 00:29]</p>",
            "ownReply": false
        },
        {
            "author": "zaterdag 29 januari 2011 13:45",
            "date": "",
            "contentHtml": "Leuk op te lezen. Ik zit er zelf ook aan te denken om mijn eigen code om te zetten in een JQuery plugin, hoewel ik naast mooiigheid nog geen voordelen zie. <br>\r\n<br>\r\nOh wat wacht ik op PythonScript...",
            "ownReply": false
        }
    ]
}