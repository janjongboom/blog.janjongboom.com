{
    "title": "Custom Attributes op enum's",
    "language": "nl",
    "link": "http://glamour.tweakblogs.net/blog/5788/custom-attributes-op-enums.html",
    "date": "2010-12-21T13:21:00.000Z",
    "category": "Backend",
    "views": 2632,
    "articleHtml": "Nogal vaak zie ik code in een MVC Controller staan als:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">enum</span>&#xA0;<span class=\"code_ident\">Pagina</span>\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;[<span class=\"code_method\">UrlPart</span>(<span class=\"code_string\">&quot;&quot;</span>)]\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">Index</span>,\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;[<span class=\"code_method\">UrlPart</span>(<span class=\"code_string\">&quot;about-us&quot;</span>)]\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">OverOns</span>,\n<br>}</code></div></td></tr></table><br>\r\nWaarbij er acties zijn als:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">void</span>&#xA0;<span class=\"code_method\">MaakLink</span>&#xA0;(<span class=\"code_ident\">Pagina</span>&#xA0;<span class=\"code_ident\">targetPagina</span>)\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">string</span>&#xA0;<span class=\"code_ident\">urlPart</span>&#xA0;=&#xA0;...;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;hierboven&#xA0;moeilijke&#xA0;code&#xA0;om&#xA0;&apos;UrlPart&apos;&#xA0;attribute&#xA0;te&#xA0;vinden</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;op&#xA0;de&#xA0;huidige&#xA0;waarde&#xA0;van&#xA0;de&#xA0;enum</span>\n<br>}</code></div></td></tr></table><br>\r\nDaarom vandaag een kleine snippet, die eenvoudig een attribute kan uitlezen van een enum, waarbij de syntax als volgt wordt:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">string</span>&#xA0;<span class=\"code_ident\">urlPart</span>&#xA0;=&#xA0;<span class=\"code_ident\">targetPagina</span>.<span class=\"code_ident\">GetCustomAttribute</span>&lt;<span class=\"code_ident\">UrlPartAttribute</span>&gt;().<span class=\"code_ident\">EenProperty</span>;</code></div></td></tr></table><br><a name=\"more\"></a><br>\r\n<b>Implementatie</b><br>\r\nAls extension method vrij eenvoudig te bakken als je je beseft dat waardes van een enum als &apos;fields&apos; op het type zitten:<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br></code></td><td class=\"phphighlightcode\"><div><code>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">static</span>&#xA0;<span class=\"code_keyword\">class</span>&#xA0;<span class=\"code_ident\">EnumExtender</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">static</span>&#xA0;<span class=\"code_ident\">T</span>&#xA0;<span class=\"code_ident\">GetCustomAttribute</span>&lt;<span class=\"code_ident\">T</span>&gt;(<span class=\"code_keyword\">this</span>&#xA0;<span class=\"code_ident\">System</span>.<span class=\"code_ident\">Enum</span>&#xA0;<span class=\"code_ident\">enumValue</span>)\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">where</span>&#xA0;<span class=\"code_ident\">T</span>&#xA0;:&#xA0;<span class=\"code_keyword\">class</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_ident\">T</span>[]&#xA0;<span class=\"code_ident\">attributes</span>&#xA0;=&#xA0;(<span class=\"code_ident\">T</span>[])&#xA0;<span class=\"code_ident\">enumValue</span>.<span class=\"code_method\">GetType</span>().<span class=\"code_method\">GetField</span>(<span class=\"code_ident\">enumValue</span>.<span class=\"code_method\">ToString</span>()).<span class=\"code_method\">GetCustomAttributes</span>(<span class=\"code_keyword\">typeof</span>(<span class=\"code_ident\">T</span>),&#xA0;<span class=\"code_keyword\">false</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_ident\">attributes</span>.<span class=\"code_ident\">Length</span>&#xA0;&gt;&#xA0;<span class=\"code_number\">0</span>&#xA0;?&#xA0;<span class=\"code_ident\">attributes</span>[<span class=\"code_number\">0</span>]&#xA0;:&#xA0;<span class=\"code_keyword\">default</span>(<span class=\"code_ident\">T</span>);\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;}</code></div></td></tr></table>",
    "nextLink": "http://glamour.tweakblogs.net/blog/5780/typfouten-levenshtein-en-burkhard-keller-trees.html",
    "comments": [
        {
            "author": "RedHornet",
            "date": "dinsdag 21 december 2010 14:25",
            "contentHtml": "Hij is handig, maar beetje kort door de bocht. Default(T) zal altijd null zijn, waardoor .EenProperty niet meer werkt. <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":P\"> Verder inderdaad iets wat veel mensen met rare methoden proberen op te zoeken voor iets wat relatief eenvoudig met reflection te doen is <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\">",
            "ownReply": false
        },
        {
            "author": "creator1988",
            "date": "dinsdag 21 december 2010 14:33",
            "contentHtml": "<blockquote><div class=\"quote\"><a href=\"http://glamour.tweakblogs.net/blog/5788/custom-attributes-op-enums.html#r_77713\">RedHornet schreef op dinsdag 21 december 2010 @ 14:25:</a><br>\r\nHij is handig, maar beetje kort door de bocht. Default(T) zal altijd null zijn, waardoor .EenProperty niet meer werkt. <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":P\"> Verder inderdaad iets wat veel mensen met rare methoden proberen op te zoeken voor iets wat relatief eenvoudig met reflection te doen is <img src=\"http://tweakimg.net/g/s/smile.gif\" width=\"15\" height=\"15\" alt=\":)\"></div></blockquote>Uiteraard helemaal gelijk, maar ik probeer in dit soort snippets in &#xE9;&#xE9;n line het nut van zoiets duidelijk te maken.<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">string</span>&#xA0;<span class=\"code_ident\">urlPart</span>&#xA0;=&#xA0;(<span class=\"code_ident\">targetPagina</span>.<span class=\"code_ident\">GetCustomAttribute</span>&lt;<span class=\"code_ident\">UrlPartAttribute</span>&gt;()&#xA0;??&#xA0;<span class=\"code_keyword\">new</span>&#xA0;<span class=\"code_ident\">UrlPartAttribute</span>&#xA0;{&#xA0;<span class=\"code_ident\">EenProperty</span>&#xA0;=&#xA0;<span class=\"code_string\">&quot;&quot;</span>&#xA0;}).<span class=\"code_ident\">EenProperty</span>;</code></div></td></tr></table><br>\r\nis toch wat minder duidelijk  <img src=\"http://tweakimg.net/g/s/puh2.gif\" width=\"15\" height=\"15\" alt=\":P\"><p class=\"edit\">[Reactie gewijzigd op dinsdag 21 december 2010 14:33]</p>",
            "ownReply": true
        },
        {
            "author": "RedHornet",
            "date": "dinsdag 21 december 2010 14:34",
            "contentHtml": "Edit: Oops code verkeerd gelezen..<br>\r\n<br>\r\nJe hebt wel gelijk hoor, maar aangezien ik nog wel eens op codeproject, experts-exchange ed. kom ben ik gewent dat men dat zelfs nogal eens niet snapt <img src=\"http://tweakimg.net/g/s/wink.gif\" width=\"15\" height=\"15\" alt=\";)\"><p class=\"edit\">[Reactie gewijzigd op dinsdag 21 december 2010 14:36]</p>",
            "ownReply": false
        },
        {
            "author": "YopY",
            "date": "dinsdag 21 december 2010 15:10",
            "contentHtml": "Ben ik blij dat je in Java gewoon functies toe kunt voegen aan een enum. In zo&apos;n geval kun je gewoon Pagina.fromUrlPart(urlPart&quot;) doen. Syntax is ook een stuk leesbaarder, vindt ik, maar da&apos;s misschien persoonlijk.<br>\r\n<br>\r\n<br>Java:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">enum</span>&#xA0;<span class=\"code_ident\">Pagina</span>&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;<span class=\"code_method\">Index</span>(<span class=\"code_string\">&quot;&quot;</span>),\n<br>&#xA0;&#xA0;&#xA0;<span class=\"code_method\">OverOns</span>(<span class=\"code_string\">&quot;about-us&quot;</span>);\n<br>\n<br>&#xA0;&#xA0;<span class=\"code_keyword\">private</span>&#xA0;<span class=\"code_ident\">String</span>&#xA0;<span class=\"code_ident\">urlPart</span>;\n<br>&#xA0;&#xA0;\n<br>&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;ctor</span>\n<br>&#xA0;&#xA0;<span class=\"code_keyword\">private</span>&#xA0;<span class=\"code_method\">Pagina</span>(<span class=\"code_ident\">String</span>&#xA0;<span class=\"code_ident\">urlPart</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">this</span>.<span class=\"code_ident\">urlPart</span>&#xA0;=&#xA0;<span class=\"code_ident\">urlPart</span>;\n<br>&#xA0;&#xA0;}\n<br>\n<br>&#xA0;&#xA0;<span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">static</span>&#xA0;<span class=\"code_method\">fromUrlPart</span>(<span class=\"code_ident\">String</span>&#xA0;<span class=\"code_ident\">urlPart</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;values()&#xA0;is&#xA0;een&#xA0;standaard&#xA0;enum&#xA0;functie&#xA0;die&#xA0;een&#xA0;array&#xA0;van&#xA0;alle&#xA0;enum&#xA0;waardes&#xA0;teruggeeft.</span>\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">for</span>(<span class=\"code_ident\">Pagina</span>&#xA0;<span class=\"code_ident\">pagina</span>&#xA0;:&#xA0;<span class=\"code_method\">values</span>())&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">if</span>&#xA0;(<span class=\"code_ident\">pagina</span>.<span class=\"code_ident\">urlPart</span>.<span class=\"code_method\">equals</span>(<span class=\"code_ident\">urlPart</span>)&#xA0;{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_ident\">urlPart</span>;\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_keyword\">return</span>&#xA0;<span class=\"code_ident\">Pagina</span>.<span class=\"code_ident\">Index</span>;&#xA0;<span class=\"code_comment\">//&#xA0;default&#xA0;waarde&#xA0;bij&#xA0;geen&#xA0;matchende&#xA0;Pagina&#xA0;gevonden.</span>\n<br>&#xA0;&#xA0;&#xA0;}\n<br>&#xA0;&#xA0;}\n<br>}</code></div></td></tr></table><br>\r\n<br>\r\n/verkapte java &gt; c# post<br>\r\n<br>\r\nEdit: hm, zie dat jouw code wat generieker is / lijkt te zijn, en toe te passen is op alle enums. Dat kan weer niet in Java, helaas, Java enums ondersteunen geen inheritance. Volgens mij kun je ook niet een functie maken die &apos;een enum&apos; ontvangt. Je zou wel iets met een interface kunnen doen misschien, maar dat is nog steeds niet heel erg elegant.<br>\r\n<br>\r\nBasis enum-type kunnen extenden. C# &gt; Java.<p class=\"edit\">[Reactie gewijzigd op dinsdag 21 december 2010 15:14]</p>",
            "ownReply": false
        },
        {
            "author": "Snake",
            "date": "dinsdag 21 december 2010 22:17",
            "contentHtml": "Meh, in C# kan je ook extension methods schrijven op enums.<br>\r\n<br>\r\n<br>C#:<br><table class=\"phphighlight\"><tr><td class=\"phphighlightline\"><code>1<br>2<br>3<br>4<br></code></td><td class=\"phphighlightcode\"><div><code><span class=\"code_keyword\">public</span>&#xA0;<span class=\"code_keyword\">static</span>&#xA0;<span class=\"code_keyword\">void</span>&#xA0;<span class=\"code_method\">Test</span>(<span class=\"code_keyword\">this</span>&#xA0;<span class=\"code_ident\">MySweetEnum</span>&#xA0;<span class=\"code_keyword\">enum</span>)\n<br>{\n<br>&#xA0;&#xA0;&#xA0;&#xA0;<span class=\"code_comment\">//&#xA0;get&#xA0;custom&#xA0;attribute&#xA0;of&#xA0;enum&#xA0;and&#xA0;redirect</span>\n<br>}</code></div></td></tr></table>",
            "ownReply": false
        }
    ]
}